<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="es" lang="es"><head><title>Revista PHP - Upload de Imagem</title>



	<meta name="resource-types" content="document">
	<meta http-equiv="pragma" content="no-cache">
	<meta name="revisit-after" content="1">
	<meta name="classification" content="Internet">
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	<meta name="Description" content="Revista PHP é a primeira revista do Brasil criada para desenvolvedores PHP.">
	<meta name="Keywords" content=" php, php4, php5, php6, smart, phpeclipse,zend,zend2, java, sql, mysql, postgresql, oracle,oci, phpmagazine, javascript, css, XHTML HTML, tableless, revista, magazine, XML, postgres, Zend Framework">
	<meta name="robots" content="ALL">
	<meta name="distribution" content="Global">
	<meta name="ICBM" content="-20.2982,-40.3298">
	<meta name="DC.title" content="Revista PHP">
	<meta name="rating" content="General">
	<meta name="author" content="Revista PHP">
	<meta name="language" content="pt-br">
	<meta name="doc-class" content="Completed">

	<meta name="doc-rights" content="Public">
	<link rel="shortcut icon" href="http://www.revistaphp.com.br/ico/favicon.ico">
	

	<link rel="stylesheet" type="text/css" href="Upload%20de%20Imagem_arquivos/artigos.css">

	<link rel="stylesheet" type="text/css" href="Upload%20de%20Imagem_arquivos/artigo.css">

    <style type="text/css">
<!--
.style1 {color: #FF6600}
.style3 {color: #000033}
.style2 {color: #FF6600}
.style4 {color: #F0F0F0}
.style5 {color: #669900}
#Layer2 {
	position:absolute;
	left:16px;
	top:147px;
	width:565px;
	height:27px;
	z-index:2;
}

-->
    </style>
    <script type="text/JavaScript">
<!--
function MM_openBrWindow(theURL,winName,features) { //v2.0
  window.open(theURL,winName,features);
}
//-->
    </script><script charset="utf-8" id="injection_graph_func" src="Upload%20de%20Imagem_arquivos/injection_graph_func.js"></script></head><body>
	
	<div id="web">
<script>
//Verificar se a resolução vídeo for > 800 X 600
if(screen.width > 800)
{
	document.write ('<div style="display: block;" id="barradireita" >');
	document.write ('<div class="BarraBox" >');
	document.write ('<h2><a href="http://www.revistaphp.com.br/"><span>Revista PHP</span></a></h2>');
	document.write ('<ul><li>')
	document.write ('<iframe name="topo" width="160" height="600" src="barra1.php" framespacing="0" frameborder="no" scrolling="no"  allowtransparency="true" marginwidth="0" marginheight="0">')
	document.write ('</iframe>')
	document.write ('</li></ul>')
	document.write ('</div>');
	document.write ('</div>');
}

</script><div style="display: block;" id="barradireita"><div class="BarraBox"><h2><a href="http://www.revistaphp.com.br/"><span>Revista PHP</span></a></h2><ul><li><iframe name="topo" src="Upload%20de%20Imagem_arquivos/barra1.htm" framespacing="0" allowtransparency="true" marginwidth="0" marginheight="0" frameborder="no" height="600" scrolling="no" width="160"></iframe></li></ul></div></div> 
	 <div id="publicidade">
	  <a href="http://tehospedo.com.br/?xind=revistaphp.com.br" target="_blank"><img style="display: none;" src="Upload%20de%20Imagem_arquivos/banner_revistaPHP.gif" border="0" height="90" width="728"></a>
</div>
<div id="toporevista">
			<a href="http://www.revistaphp.com.br/index.php" id="logo"><img src="Upload%20de%20Imagem_arquivos/logo.gif" alt="Revista PHP" img="" border="0" height="93" width="246"></a>
			<a href="http://www.revistaphp.com.br/index.php" id="banner"><img style="display: none;" src="Upload%20de%20Imagem_arquivos/banner120.gif" alt="Revista PHP" onclick="MM_openBrWindow('upload.php','artigo','width=400,height=280')" img="" border="0" height="60" width="120"></a>

			<form method="get" action="artigos_resultado.php" name="form_search" id="buscador">
				Palavra:&nbsp;&nbsp;&nbsp; 
				<input name="p" size="38" maxlength="255" style="border: 1px solid rgb(153, 153, 153);" value="" id="sbi" class="form_search_input" type="text"><img title="Max field length is 255" style="border: 0pt none ; width: 14px; height: 19px; cursor: pointer;" class="ife_marker" src="Upload%20de%20Imagem_arquivos/marker.png" id="p_ife_marker_0" align="absmiddle">
				<label> <br>
				Categoria:
                <select name="c" class="form_search_select" id="c" style="border: 1px solid rgb(153, 153, 153); width: 120px;">

				  <option value="0">Selecione...</option>
<option value="6">Acessibilidade</option><option value="2">AJAX</option><option value="3">Banco de Dados</option><option value="4">CSS</option><option value="15">Frameworks</option><option value="13">GTK</option><option value="16">IDEs</option><option value="8">Java Script</option><option value="17">Miscelânea </option><option value="10">MySQL</option><option value="11">Oracle</option><option value="1">PHP</option><option value="14">Segurança</option><option value="7">Tableless </option><option value="12">Templates</option><option value="9">XHTML</option><option value="5">XML</option>	            </select>
				</label>
			  <label>
					<input name="buscar" src="Upload%20de%20Imagem_arquivos/btn-buscar.gif" type="image">
			  </label>
			</form>		
</div><div id="Destaque">
			<div id="Cabecalho">
 	<h2>Revista PHP  /  PHP</h2>
				
	            <ul class="submenu">
		<li class="texto"><strong>Publicado:  27/12/2006</strong></li>
        <li class="ultimo-lista"><a href="http://www.revistaphp.com.br/colaborador.php?cduser=83"> Ver todos artigos</a></li>
</ul>
					<div id="DestaqueFundo">
					
		<div class="DestaqueTexto">
			<div>
   	
   <a href="http://www.revistaphp.com.br/colaborador.php?cduser=83" class="imagem"><img class="imagem" src="Upload%20de%20Imagem_arquivos/83.jpg" title="Luis Henrique" border="0" height="75" width="65"></a>				
	<h3>Luis Henrique</h3>
	<p class="descricao-corta">Desenvolvedor PHP,mysql, atualmente trabalhando com sites em tableless, ajax e estuda C e Phyton</p>	
				
		  </div>		
		</div>			
		</div>			
	</div>
			
	  </div>
	  
		<div id="opcoes_artigos">
		  <div id="interacao">
		    <ul class="submenu"><script type="text/javascript"><!--
google_ad_client = "pub-1912416589418666";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al";
google_ad_channel = "";
google_color_border = "FFFFFF";
google_color_bg = "FFFFFF";
google_color_link = "006699";
google_color_text = "000000";
google_color_url = "008000";
//-->
</script>
<script style="display: none;" type="text/javascript" src="barra1_data/show_ads.js">
</script>
            </ul>
		  </div>
		</div>
		
		<div id="novidades-foro">
			<div id="novidades">
				<h2>Upload de Imagem</h2>
			
		
				<div id="novidades-content">
			    <div class="descricao">
				<p>Olá , sei  que estou meio  sumido, mais e o trabalho aqui que esta 
matando, mais tudo bem, vamos a ação e deixar de papo furado. </p>
<p>O que temos aqui e um sistema de multiplo Upload de Imagem com thundball e
  caminho no mysql,  com thundball e gravando  no mysql.</p>
<p>Para facilitar está todo comentado para facilitar  adaptar a sua necessidade</p>
<p><strong>index.html </strong></p>
<pre class="code">HTML&gt;<br>&lt;HEAD&gt;<br>&lt;TITLE&gt;Novo Documento&lt;/TITLE&gt;<br>&lt;/HEAD&gt;<br>&lt;style type="text/css"&gt;<br>*{ float:left;<span class="style2">/* todos para esquerda e quem chegar ganhar um &lt;br&gt; */</span><br>clear:both;<span class="style2">/*aqui o br qu e prometir*/</span><br>margin:1px;<span class="style2">/*uma margin manera*/</span>

}
&lt;/style&gt;
<br>&lt;BODY&gt;<br>&lt;form method="POST" enctype="multipart/form-data" action="manda.php"&gt;

vamos ver agora :

&lt;input type="file" name="ball" &gt;<br>&lt;input type="file" name="arquivo[]"&gt;<br>&lt;input type="file" name="arquivo[]"&gt;<br>&lt;input type="file" name="arquivo[]"&gt;

&lt;input type="submit" name="submit" value="upload"&gt;<br>&lt;/form&gt;<br>&lt;/BODY&gt;<br>&lt;/HTML&gt;</pre>
<br>
<p><strong>manda.php</strong></p>

<pre class="code"><font color="#ff0000">&lt;?php</font><br><font color="#ff6600">/***********************************<br>http://www.jellyandcustard.com/2006/04/05/file-uploads/<br>inspirado nesse site para esse script<br>************************************/</font><br>function conecta_php() {<br>$host="imysql01";<br>$user="i3980426";<br>$senha= "4l397ay41tx8hehd";<br>$banco="i3980426";<br>$conect = mysql_connect($host,$user,$senha)or die("deu erro e mole");<br>mysql_select_db($banco)or die ("o banco sumiu");

}

$dir="./imagem/";<span class="style2">//caminho no caso de um window<br>// para onde vai as imagem */</span>

<span class="style2">/* $caminho_mysql="localhost/upload/imagem/";<br>caminho para o mysql achar quando vc for chama<br>comentei $caminho-mysql e no sei o seu caminho ai */</span>

$ball=$_FILES['ball']['name'];<br><span class="style2">//recebendo a imagem</span>

$caminho1=$dir.$ball;<br><span class="style2">//caminho com nome da imagem e local para guardar</span>

if(move_uploaded_file($_FILES['ball']['tmp_name'],$caminho1))<br><span class="style2">//aqui nada especial so movo a tmp_name dando caminho</span>

<span class="style2">{<br>list($largura,$altura,$tipo)=getimagesize($caminho1);<br>/* baseado no caminho do move_upload($caminho1)<br>tu sabe que list faz ???/<br>essa função getimagesize ele tem uma array com as informações de<br>imagem<br>ela retorna quatros elementos de uma imagem<br>0-largura<br>1-altura<br>2-tipo ser e uma jpg ou png gif<br>dentro de tipo o gif e 1,jpg 2 e 3 png<br>$atributos tem a largura e altura da imagem<br>entendeu<br>seu quiser sabe se a imagem e um jpg<br>e so fazer<br>*if($tipo=2) {<br>echo $imagem1 ."is jpg";<br>exit ();<br>
} */</span>

$imagem = imagecreatefromjpeg($caminho1);

<span class="style2">// aqui eu pego a imagem no caminho e jogo na memoria</span><br>$Thumbnail = imagecreatetruecolor(75, 75);

<span class="style2">// diminuir a imagem preservado as cores e diminiudo a imagem</span><br>imagecopyresampled($Thumbnail, $imagem, 0, 0, 0, 0, 75, 75, $largura,$altura);<br><span class="style2">//sample da imagem com os tamanho 75 x75</span>

imagejpeg($Thumbnail,$dir.'/pequena_'.$ball);<br><span class="style2">//$dir esta la em cima esqueceu aqui a imagem vai pequena<br>// criando a imagem</span><br>$pequena=$caminho_mysql.'pequena_'.$ball;<br><span class="style2">/*aqui eu criei uma variavel para o mysql ja que o caminho final e la
gere a imagem e coloco no Diretorio de imagem<br>e ganhar uma nova imagem algo tipo pequena_image que veio para mim.jpg<br>*/</span>

}

$image=$_FILES['arquivo'];

<span class="style2">//aqui eu recebo a imagem olha o formulario la arquivo []</span>

for($i=0; $i &lt; sizeof($image);$i++)

<span class="style2">/*aqui e um for para organizar o bando*/</span><br>{

<span class="style2">/* o bando vai ser organizado aqui<br>virando um array manero e claro depois que eu<br>coloque a minha matriz[] */</span><br>$nome=$_FILES ['arquivo']['name'][$i];<br>$tamanho=$_FILES ['arquivo']['size'][$i];<br>$tipo=$_FILES ['arquivo']['type'][$i];<br>$tmpname=$_FILES ['arquivo']['tmp_name'][$i];<br>$matriz[]=$nome;<br><span class="style2">/* pq eu precisava desse campo com o array livre<br>para os campo do mysql*/</span><br>$caminho=$dir.$nome;

if($tamanho &gt; 0 &amp;&amp; strlen($nome) &gt; 1)

<span class="style2">//aqui e natural no e ???<br>//ver se tem algo pra eu movei baseado no campo<br>//de repente o cara coloco um imagem no ultimo campo<br>//eu to ferrado para jogar</span><br>{

<span class="style2">// endereço completo e o caminho para onde vai as imagem</span>

if(move_uploaded_file($tmpname,$caminho)){

echo 'imagem' . ($i+1) . ' enviada.&lt;br/&gt;';<br><span class="style2">/* Faz contagem baseada no campo<br>pq $i+1 pq veja a minha matriz como esta organizada<br>use o var_dump para melhor referencia */</span>

}
<span class="style2">//primeiro if fechado

//segundo if fechado</span><br>}

<span class="style2">//fecho for</span>

conecta_php();<br><span class="style2">// aqui e funcao conexao do banco</span>

$vamos="Insert into produto (id,foto1,foto2,foto3,foto4,pequena)VALUES<br>('','$ball','$matriz[0]','$matriz[1]','$matriz[2]','$pequena')";<br><span class="style2">// como geral gosta de separa</span><br>$vai=mysql_query($vamos)or die("deu erro aqui");<br><span class="style2">/*e la as fotos vão p/ mysql
 como estamos trabalhando ???
eu separei para geral pode ideia pra conseguir altera
qualquer duvida e so dizer eu podia te feito tudo no for

*/</span><br><font color="#ff0000">?&gt;</font></pre>
<p><br>
sql.txt </p>
<pre class="code">CREATE TABLE `produto` (<br>`id` int(11) NOT NULL auto_increment,<br>`foto1` varchar(255) NOT NULL,<br>`foto2` varchar(255) NOT NULL,<br>`foto3` varchar(255) NOT NULL,<br>`foto4` varchar(255) NOT NULL,<br>`pequena` varchar(255) NOT NULL,<br>PRIMARY KEY (`id`)<br>) ENGINE=MyISAM DEFAULT CHARSET=latin1 AUTO_INCREMENT=2 ;


INSERT INTO `produto` VALUES (1, 'Logo01.jpg', 'Logo02.jpg',<br>'Logo03.jpg', '', 'pequena_Logo01.jpg'); </pre>
<p>Espero que todos tenham gostado,&nbsp; um abraço.</p>
<p>cordialmente Henrique </p> </div></div>																																																																										
			</div>
			
		</div>
		
		
		<div id="opcoes_artigos">
		  <div id="interacao">
				<h2 align="left">Opções de Interação </h2>
				
                <div align="center">
                  <ul class="submenu">	
                            <div align="left"><img src="Upload%20de%20Imagem_arquivos/comentar.gif" style="cursor: pointer;" title="Comentar" onclick="MM_openBrWindow('pop_comentar.php?id=70','comentario','width=420,height=220')" height="21" width="100">
                              <span class="activa"><img src="Upload%20de%20Imagem_arquivos/colunista.gif" onclick="MM_openBrWindow('popups/colunista.php?c=83','colunista','width=400,height=200')" title="Fale com o colunista" style="cursor: pointer;" height="21" width="165"> </span><span class="activa"><img src="Upload%20de%20Imagem_arquivos/indicar.gif" onclick="MM_openBrWindow('popups/indicacao.php?id=70','colunista','width=400,height=200')" title="Indicar artigo" height="21" width="120"></span> <a href="http://www.revistaphp.com.br/print.php?id=70" target="_blank"><img src="Upload%20de%20Imagem_arquivos/imprimir.gif" style="cursor: pointer;" title="Versão de impressão" height="21" width="90"></a> <a href="http://groups.google.com.br/group/listaphp" target="_blank"><img src="Upload%20de%20Imagem_arquivos/duvidas.gif" title="Lista PHP Google" height="21" width="90"></a> 
							   
							   <img src="Upload%20de%20Imagem_arquivos/favoritos.gif" style="cursor: pointer;" title="Adicionar aos Favoritos" onclick="MM_openBrWindow('pop_favoritos.php?id=70&acao=add','favoritos','width=420,height=220')" height="21" width="150">
							  							  </div>
                            <li class="activa"></li>
<li class="activa">&nbsp;</li>
</ul>
            </div>
              <ul class="submenu">
            </ul>
		  </div>
		</div>
	<div id="novidades-foro">
			<div id="novidades">
				<h2>Comentários</h2>
				
	            <ul class="submenu">	
		<li class="activa"><a style="cursor: pointer;" onclick="MM_openBrWindow('pop_comentar.php?id=70','comentario','width=420,height=220')">Incluir Comentário  </a></li>
<li class="ultimo-lista"><a href="#"> Ver todos </a></li>
<li class="activa"></li></ul>
		
				<div id="novidades-content">
			    <div class="descricao">
				  				    
			              <div class="style1" id="comentarios_tiluto">
		                  Como mandar somente a imagem redimencionada				  </div>
				        <div id="comentarios_nome"><span class="style2">
			            Por: </span><span class="style3">rodrigo</span>, 
				          16/07/2007&nbsp;&nbsp;&nbsp;19:18:26</div>
				        <div id="comentarios_texto">
Gostaria de enviar somente a imagem redimencionada sem o de tamanho
original.. Uso o PHP 5 e estou quebrando a cabeça com isso... </div>				    
			        			      </div>
				</div>																																																																										
			</div>
			
	  </div>
	  <div id="final"><a href="http://www.revistaphp.com.br/index.php"><img src="Upload%20de%20Imagem_arquivos/logo.gif" border="0" height="93" width="246"></a>
</div>
		
</div>
	<script src="Upload%20de%20Imagem_arquivos/urchin.js" type="text/javascript"></script>
	<script type="text/javascript">
		_uacct = "UA-313498-1";
		urchinTracker();
	</script>
</body></html>